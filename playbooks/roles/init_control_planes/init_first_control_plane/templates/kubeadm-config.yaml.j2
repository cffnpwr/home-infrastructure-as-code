apiVersion: kubeadm.k8s.io/v1beta4
kind: InitConfiguration
{% if cni == "cilium" %}
skipPhases:
  - addon/kube-proxy
{% endif %}
---
apiVersion: kubeadm.k8s.io/v1beta4
kind: ClusterConfiguration
controlPlaneEndpoint: "{{ apiserver_endpoint }}"
clusterName: "{{ cluster_name | default('kubernetes') }}"
networking:
  podSubnet: "{{ pod_network_cidr | default('10.244.0.0/16') }}"
apiServer:
  certSANs:
    - "{{ vip }}"
